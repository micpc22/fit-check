<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FITTCHECK ‚Äî Fitness Tracker</title>
  <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
  <style>
    /* Reset & Base */
    * { box-sizing: border-box; margin: 0; padding: 0; }
    :root {
      --accent: #5b9bd5;
      --accent-dark: #7ab3e8;
      --accent-hover: #4a8bc4;
      --muted: #a0a8b5;
      --bg: #0e1621;
      --card: #1b2430;
      font-family: 'Inter', system-ui, -apple-system, "Segoe UI", Roboto, sans-serif;
    }
    html, body {
      background: linear-gradient(135deg, var(--bg) 0%, #1a2332 100%);
      min-height: 100vh;
      color: #fff;
    }

    /* Header */
    .site-header {
      background: rgba(14, 22, 33, 0.95);
      backdrop-filter: blur(8px);
      position: sticky;
      top: 0;
      z-index: 50;
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
    }
    .header-inner {
      max-width: 1280px;
      margin: 0 auto;
      padding: 1rem 1.25rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .logo {
      color: #fff;
      font-size: 1.25rem;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      text-decoration: none;
    }
    .main-nav {
      display: none;
      align-items: center;
      gap: 2rem;
    }
    .main-nav.desktop { display: flex; }
    .main-nav a, .main-nav button {
      color: #d1d5db;
      text-decoration: none;
      padding: 0.5rem 0.75rem;
      border-radius: 0.5rem;
      transition: all 0.3s;
      font-size: 0.95rem;
      font-weight: 500;
      background: none;
      border: none;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
    }
    .main-nav a:hover, .main-nav button:hover {
      color: var(--accent-dark);
      background: rgba(91, 155, 213, 0.15);
    }
    /* ‚úÖ ACTIVE NAV FIX */
    .nav-active {
      color: var(--accent-dark) !important;
      background: rgba(91, 155, 213, 0.15) !important;
    }
    .menu-toggle {
      display: none;
      background: none;
      border: none;
      color: white;
      font-size: 1.5rem;
      cursor: pointer;
    }
    .main-nav.mobile {
      display: none;
      flex-direction: column;
      background: var(--card);
      position: absolute;
      top: 100%;
      right: 1.25rem;
      width: 200px;
      border-radius: 0.5rem;
      padding: 1rem;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
      gap: 0.5rem;
    }
    .main-nav.mobile.show { display: flex; }

    /* Notifications */
    .notification-bell {
      position: fixed;
      top: 1rem;
      right: 1rem;
      z-index: 100;
      background: var(--accent);
      color: white;
      border: none;
      border-radius: 50%;
      width: 3rem;
      height: 3rem;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      transition: all 0.3s;
    }
    .notification-bell:hover {
      background: var(--accent-dark);
      transform: scale(1.1);
    }
    .notification-badge {
      position: absolute;
      top: -0.25rem;
      right: -0.25rem;
      background: #dc2626;
      color: white;
      font-size: 0.75rem;
      border-radius: 50%;
      width: 1.25rem;
      height: 1.25rem;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .notification-panel {
      display: none;
      position: fixed;
      top: 5rem;
      right: 1rem;
      width: 20rem;
      max-height: 24rem;
      background: var(--card);
      border-radius: 0.75rem;
      box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
      border: 1px solid rgba(91, 155, 213, 0.3);
      z-index: 99;
      overflow: hidden;
    }
    .notification-panel.active { display: block; }
    .notification-header {
      display: flex;
      justify-content: space-between;
      padding: 1rem;
      border-bottom: 1px solid rgba(91, 155, 213, 0.2);
    }
    .clear-all-btn {
      color: var(--accent);
      background: none;
      border: none;
      cursor: pointer;
      transition: color 0.2s;
    }
    .notification-list {
      max-height: 20rem;
      overflow-y: auto;
    }
    .notification-item {
      padding: 1rem;
      border-bottom: 1px solid rgba(91, 155, 213, 0.1);
    }
    .notification-empty { text-align: center; color: var(--muted); padding: 2rem; }
    .toast-container {
      position: fixed;
      bottom: 1rem;
      right: 1rem;
      z-index: 100;
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }
    .toast {
      background: var(--card);
      border: 1px solid var(--accent);
      border-radius: 0.5rem;
      padding: 1rem;
      max-width: 20rem;
      box-shadow: 0 10px 25px rgba(0,0,0,0.5);
      animation: slideIn 0.3s;
    }
    @keyframes slideIn {
      from { transform: translateX(100%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }

    /* Layout */
    .container { max-width: 1280px; margin: 0 auto; padding: 0 1.25rem; }
    main { padding: 3rem 0; }
    .page-header {
      text-align: center;
      background: linear-gradient(135deg, #1b2430 0%, #0e1621 100%);
      padding: 3rem 0 2rem;
      border-bottom: 2px solid var(--accent);
      margin: -3rem -1.25rem 2rem;
    }
    .page-header h1 {
      color: var(--accent-dark);
      font-size: 2.5rem;
      margin-bottom: 0.75rem;
    }

    /* Tabs */
    .tab-list {
      display: flex;
      gap: 0.5rem;
      background: var(--card);
      padding: 0.5rem;
      border-radius: 0.5rem;
      overflow-x: auto;
    }
    .tab-button {
      padding: 0.5rem 1.5rem;
      background: transparent;
      border: none;
      color: #d1d5db;
      cursor: pointer;
      border-radius: 0.375rem;
      font-weight: 500;
      transition: all 0.2s;
      white-space: nowrap;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    .tab-button:hover { background: rgba(255,255,255,0.05); }
    .tab-button.active { background: var(--accent); color: white; }
    .tab-content { display: none; }
    .tab-content.active { display: block; }

    /* Grid & Cards */
    .grid { display: grid; gap: 1.5rem; }
    .grid-3 { grid-template-columns: 1fr; }
    .grid-4 { grid-template-columns: 1fr; }
    @media (min-width: 768px) { .grid-3 { grid-template-columns: repeat(3, 1fr); } }
    @media (min-width: 1024px) { .grid-4 { grid-template-columns: repeat(4, 1fr); } }

    .card {
      background: var(--card);
      padding: 1.5rem;
      border-radius: 0.75rem;
      border: 1px solid rgba(255,255,255,0.05);
      box-shadow: 0 4px 6px rgba(0,0,0,0.3);
    }
    .card h2, .card h3 {
      color: var(--accent-dark);
      margin-bottom: 1.5rem;
      font-size: 1.25rem;
    }

    /* Forms & Inputs */
    .form-group { margin-bottom: 1rem; }
    label {
      display: block;
      margin-bottom: 0.5rem;
      color: #d1d5db;
      font-weight: 500;
    }
    input, select {
      width: 100%;
      padding: 0.625rem;
      background: rgba(0,0,0,0.3);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 0.5rem;
      color: white;
    }
    input:focus, select:focus {
      outline: none;
      border-color: var(--accent);
    }
    button {
      padding: 0.625rem 1.5rem;
      background: var(--accent);
      color: white;
      border: none;
      border-radius: 0.5rem;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.2s;
    }
    button:hover { background: var(--accent-hover); }
    button.btn-outline {
      background: transparent;
      border: 1px solid var(--accent);
      color: var(--accent);
    }
    button.btn-outline:hover {
      background: var(--accent);
      color: white;
    }
    button.btn-full { width: 100%; }

    /* Stats & Entries */
    .stats-box {
      background: rgba(91,155,213,0.1);
      border-left: 4px solid var(--accent);
      padding: 1rem;
      margin-bottom: 0.75rem;
    }
    .entry-item {
      background: rgba(255,255,255,0.02);
      border-radius: 0.5rem;
      padding: 1rem;
      margin-bottom: 0.75rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border: 1px solid rgba(255,255,255,0.05);
    }
    .entry-item .delete-btn {
      background: none;
      border: none;
      color: #ef4444;
      font-size: 1rem;
      cursor: pointer;
    }
    .stat-card {
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }
    .stat-card .icon {
      background: rgba(91,155,213,0.2);
      padding: 0.75rem;
      border-radius: 0.5rem;
      font-size: 1.5rem;
    }
    .stat-card .value { font-weight: 600; font-size: 1.05rem; }
    .stat-card .label { color: var(--muted); font-size: 0.9rem; }
    .empty-state { text-align: center; color: var(--muted); padding: 3rem 1rem; }

    /* Scrollable */
    .scrollable {
      max-height: 500px;
      overflow-y: auto;
    }
    .scrollable::-webkit-scrollbar { width: 8px; }
    .scrollable::-webkit-scrollbar-track { background: rgba(255,255,255,0.05); border-radius: 4px; }
    .scrollable::-webkit-scrollbar-thumb { background: var(--accent); border-radius: 4px; }

    /* Footer */
    .site-footer {
      background: rgba(0,0,0,0.5);
      color: #9ca3af;
      margin-top: 3rem;
      border-top: 1px solid rgba(255,255,255,0.05);
      padding: 1.5rem 0;
    }
    .footer-inner { display: flex; justify-content: space-between; flex-wrap: wrap; gap: 1rem; }
    .footer-nav { display: flex; gap: 1.5rem; }
    .footer-nav a {
      color: #9ca3af;
      text-decoration: none;
      font-size: 0.875rem;
    }
    .footer-nav a:hover { color: var(--accent-dark); }

    /* Responsive */
    @media (min-width: 768px) {
      .menu-toggle { display: none; }
      .main-nav.desktop { display: flex; }
    }
    @media (max-width: 767px) {
      .menu-toggle { display: block; }
      .main-nav.desktop { display: none; }
    }
    .hidden { display: none; }
  </style>
</head>
<body>
  <!-- Notifications -->
  <button class="notification-bell" id="notificationBell">
    <i class='bx bxs-bell'></i>
    <span class="notification-badge" id="notificationBadge" style="display: none;">0</span>
  </button>
  <div class="notification-panel" id="notificationPanel">
    <div class="notification-header">
      <h3>Notifications</h3>
      <button class="clear-all-btn" id="clearAllBtn">Clear All</button>
    </div>
    <div class="notification-list" id="notificationList">
      <div class="notification-empty">No new notifications</div>
    </div>
  </div>
  <div class="toast-container" id="toastContainer"></div>

  <!-- Header -->
  <header class="site-header">
    <div class="header-inner">
      <a href="index.html" class="logo">
        <i class='bx bxs-dumbbell'></i> FITTCHECK
      </a>
      <nav class="main-nav desktop">
        <a href="index.html" id="nav-home"><i class='bx bx-home'></i> Home</a>
        <a href="classes.html" id="nav-classes"><i class='bx bx-dumbbell'></i> Classes</a>
        <a href="trainers.html" id="nav-trainers"><i class='bx bx-user-check'></i> Trainers</a>
        <a href="contact.html" id="nav-about"><i class='bx bx-info-circle'></i> About Us</a>
        <a href="tracker.html" id="nav-tracker"><i class='bx bx-trending-up'></i> Tracker</a>
        <button onclick="window.location.href='profile.html'" id="nav-profile"><i class='bx bx-user'></i> Profile</button>
      </nav>
      <button class="menu-toggle" id="menuToggle">‚ò∞</button>
      <nav class="main-nav mobile" id="mobileNav">
        <a href="index.html" id="nav-home-mobile"><i class='bx bx-home'></i> Home</a>
        <a href="classes.html" id="nav-classes-mobile"><i class='bx bx-dumbbell'></i> Classes</a>
        <a href="trainers.html" id="nav-trainers-mobile"><i class='bx bx-user-check'></i> Trainers</a>
        <a href="contact.html" id="nav-about-mobile"><i class='bx bx-info-circle'></i> About Us</a>
        <a href="tracker.html" id="nav-tracker-mobile"><i class='bx bx-trending-up'></i> Tracker</a>
        <button onclick="window.location.href='profile.html'" id="nav-profile-mobile"><i class='bx bx-user'></i> Profile</button>
      </nav>
    </div>
  </header>

  <main class="container">
    <div class="page-header">
      <h1>Fitness Tracker</h1>
      <p>Track your calories, weight, and workouts to reach your fitness goals.</p>
    </div>

    <!-- Tabs -->
    <div class="tab-list">
      <button class="tab-button active" data-tab="dashboard"><i class='bx bx-home'></i> Dashboard</button>
      <button class="tab-button" data-tab="calories"><i class='bx bx-food-menu'></i> Calories</button>
      <button class="tab-button" data-tab="weight"><i class='bx bx-scale'></i> Weight</button>
      <button class="tab-button" data-tab="workouts"><i class='bx bx-dumbbell'></i> Workouts</button>
    </div>

    <!-- Dashboard -->
    <div class="tab-content active" id="dashboard-tab">
      <div class="card">
        <h2>Your Goals</h2>
        <div class="grid grid-3">
          <div class="stats-box"><div class="label">Daily Calorie Goal</div><div class="value" id="goal-cal">2000 kcal</div></div>
          <div class="stats-box"><div class="label">Target Weight</div><div class="value" id="goal-weight">70 kg</div></div>
          <div class="stats-box"><div class="label">Weekly Workouts</div><div class="value" id="goal-workouts">3</div></div>
        </div>
      </div>
      <div class="grid grid-4" style="margin-top: 1.5rem;">
        <div class="card"><div class="stat-card"><div class="icon">üî•</div><div><div class="label">Today's Calories</div><div class="value" id="stat-cal">0 / 2000</div></div></div></div>
        <div class="card"><div class="stat-card"><div class="icon">‚öñÔ∏è</div><div><div class="label">Current Weight</div><div class="value" id="stat-weight">-</div></div></div></div>
        <div class="card"><div class="stat-card"><div class="icon">üí™</div><div><div class="label">This Week</div><div class="value" id="stat-workouts">0 / 3</div></div></div></div>
        <div class="card"><div class="stat-card"><div class="icon">üéØ</div><div><div class="label">Total Entries</div><div class="value" id="stat-total">0</div></div></div></div>
      </div>
      <div class="card" style="margin-top: 1.5rem;">
        <h3>Recent Activity</h3>
        <div id="recent-activity" class="empty-state">No activity yet.</div>
      </div>
    </div>

    <!-- Calories -->
    <div class="tab-content" id="calories-tab">
      <div class="grid grid-3">
        <div class="card">
          <h2>Log Calories</h2>
          <form id="cal-form">
            <div class="form-group"><label>Date</label><input type="date" id="cal-date" required></div>
            <div class="form-group"><label>Calories</label><input type="number" id="cal-total" placeholder="2000" required></div>
            <div class="form-group"><label>Protein (g)</label><input type="number" id="cal-protein" placeholder="150"></div>
            <div class="form-group"><label>Carbs (g)</label><input type="number" id="cal-carbs" placeholder="200"></div>
            <div class="form-group"><label>Fats (g)</label><input type="number" id="cal-fats" placeholder="60"></div>
            <button type="submit" class="btn-full">Add Entry</button>
          </form>
        </div>
        <div class="card">
          <h2>Today‚Äôs Summary</h2>
          <div class="stats-box"><div class="label">Total</div><div class="value" id="today-cal">0 / 2000 kcal</div></div>
          <div class="stats-box"><div class="label">Remaining</div><div class="value" id="rem-cal">2000 kcal</div></div>
        </div>
        <div class="card">
          <h2>Recent Entries</h2>
          <div class="scrollable" id="cal-entries" style="max-height: 300px;">
            <div class="empty-state">No entries yet.</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Weight -->
    <div class="tab-content" id="weight-tab">
      <div class="grid grid-3">
        <div class="card">
          <h2>Log Weight</h2>
          <form id="weight-form">
            <div class="form-group"><label>Date</label><input type="date" id="weight-date" required></div>
            <div class="form-group"><label>Weight (kg)</label><input type="number" id="weight-val" step="0.1" placeholder="70.5" required></div>
            <button type="submit" class="btn-full">Add Entry</button>
          </form>
          <div class="stats-box"><div class="label">Target Weight</div><div class="value" id="target-weight">70 kg</div></div>
        </div>
        <div class="card" style="grid-column: span 2;">
          <h2>Weight History</h2>
          <div class="scrollable" style="max-height: 300px;" id="weight-entries">
            <div class="empty-state">No entries yet.</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Workouts -->
    <div class="tab-content" id="workouts-tab">
      <div class="grid grid-3">
        <div class="card">
          <h2>Log Workout</h2>
          <form id="workout-form">
            <div class="form-group"><label>Date</label><input type="date" id="workout-date" required></div>
            <div class="form-group"><label>Type</label>
              <select id="workout-type" required>
                <option value="">Select</option>
                <option value="Strength">üí™ Strength</option>
                <option value="Cardio">üî• Cardio</option>
                <option value="Yoga">üßò Yoga</option>
                <option value="HIIT">‚ö° HIIT</option>
              </select>
            </div>
            <div class="form-group"><label>Duration (min)</label><input type="number" id="workout-min" placeholder="45" required></div>
            <div class="form-group"><label>Calories Burned</label><input type="number" id="workout-cal" placeholder="300"></div>
            <button type="submit" class="btn-full">Log Workout</button>
          </form>
        </div>
        <div class="card">
          <h2>This Week</h2>
          <div class="stats-box"><div class="label">Workouts</div><div class="value" id="week-workouts">0 / 3</div></div>
          <div class="stats-box"><div class="label">Duration</div><div class="value" id="week-min">0 min</div></div>
        </div>
        <div class="card">
          <h2>Recent Workouts</h2>
          <div class="scrollable" id="workout-entries" style="max-height: 300px;">
            <div class="empty-state">No workouts yet.</div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <footer class="site-footer">
    <div class="container footer-inner">
      <h3><i class='bx bxs-dumbbell'></i> FITTCHECK</h3>
      <nav class="footer-nav">
        <a href="index.html">Home</a>
        <a href="classes.html">Classes</a>
        <a href="tracker.html">Tracker</a>
      </nav>
      <address><a href="mailto:hello@fittcheck.ph">hello@fittcheck.ph</a></address>
    </div>
    <div class="footer-bottom container">
      <small>¬© <span id="year"></span> FITTCHECK. All rights reserved.</small>
    </div>
  </footer>

  <script>
    // ========== STATE ==========
    let goals = { dailyCalories: 2000, targetWeight: 70, weeklyWorkouts: 3 };
    let calorieData = [], weightData = [], workoutData = [];
    let notifications = [];

    // ========== NAV ACTIVE ==========
    function setActiveNavLink() {
      const currentPage = window.location.pathname.split('/').pop() || 'index.html';
      const links = [
        { id: 'nav-home', page: 'index.html' },
        { id: 'nav-classes', page: 'classes.html' },
        { id: 'nav-trainers', page: 'trainers.html' },
        { id: 'nav-about', page: 'contact.html' },
        { id: 'nav-tracker', page: 'tracker.html' },
        { id: 'nav-profile', page: 'profile.html' }
      ];
      links.forEach(link => {
        const el = document.getElementById(link.id);
        if (currentPage === link.page) el?.classList.add('nav-active');
        else el?.classList.remove('nav-active');
      });
    }

    // ========== NOTIFICATIONS ==========
    function initializeNotifications() {
      checkMissedExercises();
      const bell = document.getElementById('notificationBell');
      const panel = document.getElementById('notificationPanel');
      bell.addEventListener('click', e => {
        e.stopPropagation(); panel.classList.toggle('active');
      });
      document.addEventListener('click', e => {
        if (!panel.contains(e.target) && e.target !== bell) panel.classList.remove('active');
      });
      document.getElementById('clearAllBtn').addEventListener('click', () => {
        notifications = []; updateNotificationUI();
      });
    }
    function checkMissedExercises() {
      const last = localStorage.getItem('lastExerciseDate');
      if (!last) return;
      const diff = Math.floor((Date.now() - new Date(last)) / (864e5));
      if (diff >= 1) {
        addNotification(`You haven‚Äôt exercised in ${diff} day${diff > 1 ? 's' : ''}! üí™`, 'missed');
      }
    }
    function addNotification(msg, type) {
      if (notifications.some(n => n.msg === msg)) return;
      notifications.unshift({ id: Date.now(), msg, type, ts: new Date() });
      updateNotificationUI();
      showToast(msg);
    }
    function updateNotificationUI() {
      const badge = document.getElementById('notificationBadge');
      const list = document.getElementById('notificationList');
      if (notifications.length) {
        badge.textContent = notifications.length;
        badge.style.display = 'flex';
        list.innerHTML = notifications.map(n =>
          `<div class="notification-item"><p>${n.msg}</p><small>${n.ts.toLocaleTimeString()}</small></div>`
        ).join('');
      } else {
        badge.style.display = 'none';
        list.innerHTML = '<div class="notification-empty">No new notifications</div>';
      }
    }
    function showToast(msg) {
      const c = document.getElementById('toastContainer');
      const t = document.createElement('div');
      t.className = 'toast';
      t.innerHTML = `<p>üîî ${msg}</p>`;
      c.appendChild(t);
      setTimeout(() => t.remove(), 5000);
    }

    // ========== MOBILE MENU ==========
    document.getElementById('menuToggle').addEventListener('click', function() {
      const nav = document.getElementById('mobileNav');
      nav.classList.toggle('show');
      this.textContent = nav.classList.contains('show') ? '‚úï' : '‚ò∞';
    });
    document.addEventListener('click', e => {
      if (!e.target.closest('.header-inner')) {
        const nav = document.getElementById('mobileNav');
        nav.classList.remove('show');
        document.getElementById('menuToggle').textContent = '‚ò∞';
      }
    });

    // ========== TABS ==========
    document.querySelectorAll('.tab-button').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.tab-button').forEach(b => b.classList.remove('active'));
        document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
        btn.classList.add('active');
        document.getElementById(btn.dataset.tab + '-tab').classList.add('active');
      });
    });

    // ========== DATA ==========
    function loadData() {
      const saved = JSON.parse(localStorage.getItem('fittcheck_data') || '{}');
      goals = saved.goals || goals;
      calorieData = saved.calorieData || [];
      weightData = saved.weightData || [];
      workoutData = saved.workoutData || [];
      updateAll();
    }
    function saveData() {
      localStorage.setItem('fittcheck_data', JSON.stringify({ goals, calorieData, weightData, workoutData }));
    }

    // ========== FORMS ==========
    document.getElementById('cal-form').addEventListener('submit', e => {
      e.preventDefault();
      calorieData.unshift({
        date: document.getElementById('cal-date').value,
        calories: +document.getElementById('cal-total').value,
        protein: +document.getElementById('cal-protein').value || 0,
        carbs: +document.getElementById('cal-carbs').value || 0,
        fats: +document.getElementById('cal-fats').value || 0
      });
      saveData(); updateAll(); e.target.reset();
    });
    document.getElementById('weight-form').addEventListener('submit', e => {
      e.preventDefault();
      weightData.unshift({
        date: document.getElementById('weight-date').value,
        weight: +document.getElementById('weight-val').value
      });
      saveData(); updateAll(); e.target.reset();
    });
    document.getElementById('workout-form').addEventListener('submit', e => {
      e.preventDefault();
      workoutData.unshift({
        date: document.getElementById('workout-date').value,
        type: document.getElementById('workout-type').value,
        duration: +document.getElementById('workout-min').value,
        caloriesBurned: +document.getElementById('workout-cal').value || 0
      });
      localStorage.setItem('lastExerciseDate', new Date().toISOString());
      saveData(); updateAll(); e.target.reset();
    });

    // ========== UPDATES ==========
    function updateAll() {
      // Goals
      document.getElementById('goal-cal').textContent = goals.dailyCalories + ' kcal';
      document.getElementById('goal-weight').textContent = goals.targetWeight + ' kg';
      document.getElementById('goal-workouts').textContent = goals.weeklyWorkouts;
      document.getElementById('target-weight').textContent = goals.targetWeight + ' kg';

      // Dashboard stats
      const today = new Date().toISOString().split('T')[0];
      const todayCal = calorieData.filter(e => e.date === today).reduce((s, e) => s + e.calories, 0);
      const weekStart = new Date();
      weekStart.setDate(weekStart.getDate() - weekStart.getDay());
      const thisWeek = workoutData.filter(e => new Date(e.date) >= weekStart).length;

      document.getElementById('stat-cal').textContent = `${todayCal} / ${goals.dailyCalories}`;
      document.getElementById('stat-workouts').textContent = `${thisWeek} / ${goals.weeklyWorkouts}`;
      document.getElementById('stat-total').textContent = calorieData.length + weightData.length + workoutData.length;

      const latestWeight = weightData.length ? weightData[0].weight : '-';
      document.getElementById('stat-weight').textContent = latestWeight !== '-' ? latestWeight + ' kg' : '-';

      // Tab-specific updates
      updateCaloriesTab();
      updateWeightTab();
      updateWorkoutsTab();
    }
    function updateCaloriesTab() {
      const today = new Date().toISOString().split('T')[0];
      const todayEntries = calorieData.filter(e => e.date === today);
      const total = todayEntries.reduce((s, e) => s + e.calories, 0);
      const rem = goals.dailyCalories - total;

      document.getElementById('today-cal').textContent = `${total} / ${goals.dailyCalories} kcal`;
      const remEl = document.getElementById('rem-cal');
      remEl.textContent = `${Math.max(0, rem)} kcal`;
      remEl.className = 'value ' + (rem >= 0 ? '' : 'text-error');

      document.getElementById('cal-entries').innerHTML = calorieData.length ?
        calorieData.map((e, i) => 
          `<div class="entry-item">
            <div>${e.calories} kcal</div>
            <button class="delete-btn" onclick="deleteEntry('cal', ${i})">√ó</button>
          </div>`
        ).join('') :
        '<div class="empty-state">No entries yet.</div>';
    }
    function updateWeightTab() {
      document.getElementById('weight-entries').innerHTML = weightData.length ?
        weightData.map((e, i) =>
          `<div class="entry-item">
            <div>${e.weight} kg ‚Äî ${e.date}</div>
            <button class="delete-btn" onclick="deleteEntry('weight', ${i})">√ó</button>
          </div>`
        ).join('') :
        '<div class="empty-state">No entries yet.</div>';
    }
    function updateWorkoutsTab() {
      const weekStart = new Date();
      weekStart.setDate(weekStart.getDate() - weekStart.getDay());
      const wk = workoutData.filter(e => new Date(e.date) >= weekStart);
      const min = wk.reduce((s, e) => s + e.duration, 0);

      document.getElementById('week-workouts').textContent = `${wk.length} / ${goals.weeklyWorkouts}`;
      document.getElementById('week-min').textContent = `${min} min`;

      document.getElementById('workout-entries').innerHTML = workoutData.length ?
        workoutData.map((e, i) =>
          `<div class="entry-item">
            <div>${e.type} ‚Äî ${e.duration} min</div>
            <button class="delete-btn" onclick="deleteEntry('workout', ${i})">√ó</button>
          </div>`
        ).join('') :
        '<div class="empty-state">No workouts yet.</div>';
    }

    // Delete helper
    function deleteEntry(type, i) {
      if (!confirm('Delete this entry?')) return;
      if (type === 'cal') calorieData.splice(i, 1);
      else if (type === 'weight') weightData.splice(i, 1);
      else if (type === 'workout') workoutData.splice(i, 1);
      saveData(); updateAll();
    }

    // ========== INIT ==========
    document.addEventListener('DOMContentLoaded', () => {
      document.getElementById('year').textContent = new Date().getFullYear();
      ['cal-date', 'weight-date', 'workout-date'].forEach(id =>
        document.getElementById(id).value = new Date().toISOString().split('T')[0]
      );
      loadData();
      initializeNotifications();
      setActiveNavLink();
    });
  </script>
</body>
</html>